---
layout: post
title: Understanding Great Circle Arcs Intersection Algorithm
date: '2014-10-19T15:51:00.001+02:00'
author: enrico_spinielli
tags:
- Spherical
- D3.js
- Geometry
modified_time: '2014-11-07T15:14:14.879+01:00'
blogger_id: tag:blogger.com,1999:blog-1947405997418753543.post-4563888999264398405
blogger_orig_url: http://ongiantsshoulders.blogspot.com/2014/10/understanding-great-circle-arcs_57.html
---

<h1 id="understanding-great-circle-arcs-intersection-algorithm">Understanding Great Circle Arcs Intersection Algorithm</h1> <p>The following material is the result of my attempt to understand the <a href="http://www.jasondavies.com/maps/intersect/" title="great circle arcs intersection">nice example</a> from Jason Davies. <br>I was puzzled about the origin of the algorithm used to find the intersection of two great circle arcs. <br>Google helped and I discovered <a href="http://www.mathworks.com/matlabcentral/newsreader/view_thread/276271" title="Roger Stafford's on Matlab newsgroup">Roger Stafford’s post</a> in Matlab newsgroup and the relevant Python’s implementation in the <a href="http://ssb.stsci.edu/doc/stsci_python_x/stsci.sphere.doc/html/_modules/stsci/sphere/great_circle_arc.html" title="intersection">Spherical Geometry Toolkit</a>.</p>   <h2 id="the-algorithm">The algorithm</h2> <p>You have two great circle arcs on a sphere, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4134-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48696" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48697"><span class="mi" id="MathJax-Span-48698" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4134">a</script> from point <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4135-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48699" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48700"><span class="texatom" id="MathJax-Span-48701"><span class="mrow" id="MathJax-Span-48702"><span class="msubsup" id="MathJax-Span-48703"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48704" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48705" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4135">\mathbf{a_0}</script> to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4136-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48706" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48707"><span class="texatom" id="MathJax-Span-48708"><span class="mrow" id="MathJax-Span-48709"><span class="msubsup" id="MathJax-Span-48710"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48711" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48712" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4136">\mathbf{a_1}</script>, and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4137-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48713" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48714"><span class="mi" id="MathJax-Span-48715" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4137">b</script> from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4138-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48716" style="width: 1.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.404em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48717"><span class="texatom" id="MathJax-Span-48718"><span class="mrow" id="MathJax-Span-48719"><span class="msubsup" id="MathJax-Span-48720"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48721" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48722" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4138">\mathbf{b_0}</script> to <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4139-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48723" style="width: 1.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.404em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48724"><span class="texatom" id="MathJax-Span-48725"><span class="mrow" id="MathJax-Span-48726"><span class="msubsup" id="MathJax-Span-48727"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48728" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48729" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4139">\mathbf{b_1}</script>, whose coordinates are expressed as longitude <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4140-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48730" style="width: 0.553em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48731"><span class="mi" id="MathJax-Span-48732" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4140">\theta</script> (positive going East of Greenwich) and latitude <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4141-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48733" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.855em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48734"><span class="mi" id="MathJax-Span-48735" style="font-family: MathJax_Math-italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.114em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4141">\phi</script> (positive going North). <br>Transform theses coordinates over to Cartesian coordinates using the equations:</p> <p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4142-Frame"><nobr><span class="math" id="MathJax-Span-48736" style="width: 8.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.46em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.198em 1000.003em 4.207em -0.298em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48737"><span class="mtable" id="MathJax-Span-48738" style="padding-right: 0.153em; padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 7.11em; height: 0px;"><span style="position: absolute; clip: rect(2.455em 1000.003em 6.309em -0.448em); top: -4.552em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -4.002em; right: 0.003em;"><span class="mtd" id="MathJax-Span-48739"><span class="mrow" id="MathJax-Span-48740"><span class="mi" id="MathJax-Span-48741" style="font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.448em); top: -2.5em; right: 0.003em;"><span class="mtd" id="MathJax-Span-48757"><span class="mrow" id="MathJax-Span-48758"><span class="mi" id="MathJax-Span-48759" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -0.948em; right: 0.003em;"><span class="mtd" id="MathJax-Span-48775"><span class="mrow" id="MathJax-Span-48776"><span class="mi" id="MathJax-Span-48777" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.557em;"></span></span><span style="position: absolute; clip: rect(2.705em 1000.003em 7.06em -0.398em); top: -5.103em; left: 0.603em;"><span style="display: inline-block; position: relative; width: 6.509em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -4.202em; left: 0.003em;"><span class="mtd" id="MathJax-Span-48742"><span class="mrow" id="MathJax-Span-48743"><span class="mo" id="MathJax-Span-48744" style="font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-48745" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">c</span><span class="mi" id="MathJax-Span-48746" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-48747" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-48748" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48749" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-48750" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-48751" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-48752" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-48753" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-48754" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48755" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-48756" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -2.7em; left: 0.003em;"><span class="mtd" id="MathJax-Span-48760"><span class="mrow" id="MathJax-Span-48761"><span class="mo" id="MathJax-Span-48762" style="font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-48763" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">s</span><span class="mi" id="MathJax-Span-48764" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-48765" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-48766" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48767" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-48768" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-48769" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-48770" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-48771" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-48772" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48773" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-48774" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -1.149em; left: 0.003em;"><span class="mtd" id="MathJax-Span-48778"><span class="mrow" id="MathJax-Span-48779"><span class="mo" id="MathJax-Span-48780" style="font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-48781" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">s</span><span class="mi" id="MathJax-Span-48782" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-48783" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-48784" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48785" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-48786" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.108em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.725em; vertical-align: -2.053em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4142">\begin{aligned} x  & = cos(\theta) cos(\phi) \\ y  & = sin(\theta) cos(\phi) \\ z  & = sin(\phi) \end{aligned}</script></p> <p>where <br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-4143-Frame"><nobr><span class="math" id="MathJax-Span-48787" style="width: 100%; display: inline-block; min-width: 7.46em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(3.206em 1000.003em 6.559em -0.448em); top: -4.052em; left: 0.003em; width: 100%;"><span class="mrow" id="MathJax-Span-48788"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.003em 4.307em -0.348em); top: -4.002em; left: 50%; margin-left: -2.6em;"><span class="mo" id="MathJax-Span-48789" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-48790" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-48791" style="font-family: MathJax_Main; padding-left: 0.303em;">≤</span><span class="mi" id="MathJax-Span-48792" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">θ</span><span class="mo" id="MathJax-Span-48793" style="font-family: MathJax_Main; padding-left: 0.303em;">≤</span><span class="mi" id="MathJax-Span-48794" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.755em 1000.003em 4.857em -0.448em); top: -2.35em; left: 50%; margin-left: -3.351em;"><span class="mspace" id="MathJax-Span-48795" style="height: 0.003em; vertical-align: 0.003em; width: 0.003em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-48796" style="font-family: MathJax_Main;">−</span><span class="mfrac" id="MathJax-Span-48797" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.448em); top: -3.201em; left: 50%; margin-left: -0.298em;"><span class="mi" id="MathJax-Span-48798" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -1.999em; left: 50%; margin-left: -0.248em;"><span class="mn" id="MathJax-Span-48799" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(0.853em 1000.003em 1.204em -0.448em); top: -1.249em; left: 0.003em;"><span style="border-left-width: 0.703em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-48800" style="font-family: MathJax_Main; padding-left: 0.303em;">≤</span><span class="mi" id="MathJax-Span-48801" style="font-family: MathJax_Math-italic; padding-left: 0.303em;">ϕ</span><span class="mo" id="MathJax-Span-48802" style="font-family: MathJax_Main; padding-left: 0.303em;">≤</span><span class="mfrac" id="MathJax-Span-48803" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 0.703em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.448em); top: -3.201em; left: 50%; margin-left: -0.298em;"><span class="mi" id="MathJax-Span-48804" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.398em); top: -1.999em; left: 50%; margin-left: -0.248em;"><span class="mn" id="MathJax-Span-48805" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(0.853em 1000.003em 1.204em -0.448em); top: -1.249em; left: 0.003em;"><span style="border-left-width: 0.703em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-48806" style="font-family: MathJax_Main; padding-left: 0.153em;">.</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.057em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.503em; vertical-align: -2.664em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4143">\begin{equation}  -\pi  \le  \theta  \le \pi \\ -\frac{\pi}{2} \le \phi \le \frac{\pi}{2}.  \end{equation}</script></p> <p>These Cartesian coordinates correspond to a hypothetical spherical “earth” of unit radius, but that does not interfere in the following computations.</p> <p>Let <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4144-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48807" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48808"><span class="texatom" id="MathJax-Span-48809"><span class="mrow" id="MathJax-Span-48810"><span class="msubsup" id="MathJax-Span-48811"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48812" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48813" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4144">\mathbf{a_0}</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4145-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48814" style="width: 1.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48815"><span class="texatom" id="MathJax-Span-48816"><span class="mrow" id="MathJax-Span-48817"><span class="msubsup" id="MathJax-Span-48818"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48819" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48820" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4145">\mathbf{a_1}</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4146-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48821" style="width: 1.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.404em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48822"><span class="texatom" id="MathJax-Span-48823"><span class="mrow" id="MathJax-Span-48824"><span class="msubsup" id="MathJax-Span-48825"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48826" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48827" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4146">\mathbf{b_0}</script>, and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4147-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48828" style="width: 1.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.404em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48829"><span class="texatom" id="MathJax-Span-48830"><span class="mrow" id="MathJax-Span-48831"><span class="msubsup" id="MathJax-Span-48832"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48833" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48834" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4147">\mathbf{b_1}</script> be vectors of the Cartesian coordinate endpoints for the two arcs <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4148-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48835" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48836"><span class="mi" id="MathJax-Span-48837" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4148">a</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4149-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48838" style="width: 4.307em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.856em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.055em 1000.003em 3.006em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48839"><span class="texatom" id="MathJax-Span-48840"><span class="mrow" id="MathJax-Span-48841"><span class="msubsup" id="MathJax-Span-48842"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48843" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48844" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48845" style="font-family: MathJax_Main; padding-left: 0.303em;">↔</span><span class="texatom" id="MathJax-Span-48846" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-48847"><span class="msubsup" id="MathJax-Span-48848"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48849" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48850" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4149">\mathbf{a_0} \leftrightarrow \mathbf{a_1}</script>) and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4150-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48851" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48852"><span class="mi" id="MathJax-Span-48853" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4150">b</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4151-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48854" style="width: 4.407em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.956em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.854em 1000.003em 3.006em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48855"><span class="texatom" id="MathJax-Span-48856"><span class="mrow" id="MathJax-Span-48857"><span class="msubsup" id="MathJax-Span-48858"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48859" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48860" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48861" style="font-family: MathJax_Main; padding-left: 0.303em;">↔</span><span class="texatom" id="MathJax-Span-48862" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-48863"><span class="msubsup" id="MathJax-Span-48864"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48865" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48866" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.058em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4151">\mathbf{b_0} \leftrightarrow \mathbf{b_1}</script>) obtained in this way. Carry out the following computations:</p> <p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4152-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48867" style="width: 6.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.408em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.105em 1000.003em 3.106em -0.398em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48868"><span class="texatom" id="MathJax-Span-48869"><span class="mrow" id="MathJax-Span-48870"><span class="mi" id="MathJax-Span-48871" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mo" id="MathJax-Span-48872" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="texatom" id="MathJax-Span-48873" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-48874"><span class="msubsup" id="MathJax-Span-48875"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48876" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48877" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48878" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-48879" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48880"><span class="msubsup" id="MathJax-Span-48881"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48882" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48883" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4152">\mathbf{p} = \mathbf{a_0} \times \mathbf{a_1}</script> is the vector normal to the plane going through the arc <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4153-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48884" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48885"><span class="mi" id="MathJax-Span-48886" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4153">a</script> and the center of the Earth.</p> <p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4154-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48887" style="width: 6.109em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.508em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 3.106em -0.398em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48888"><span class="texatom" id="MathJax-Span-48889"><span class="mrow" id="MathJax-Span-48890"><span class="mi" id="MathJax-Span-48891" style="font-family: MathJax_Main-bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-48892" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="texatom" id="MathJax-Span-48893" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-48894"><span class="msubsup" id="MathJax-Span-48895"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48896" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48897" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48898" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-48899" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48900"><span class="msubsup" id="MathJax-Span-48901"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48902" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48903" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.114em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4154">\mathbf{q} = \mathbf{b_0} \times \mathbf{b_1}</script>  is the vector normal to the plane going through the arc <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4155-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48904" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48905"><span class="mi" id="MathJax-Span-48906" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4155">b</script> and the center of the Earth.</p> <p><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4156-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-48907" style="width: 10.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.862em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.854em 1000.003em 3.156em -0.448em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48908"><span class="texatom" id="MathJax-Span-48909"><span class="mrow" id="MathJax-Span-48910"><span class="mi" id="MathJax-Span-48911" style="font-family: MathJax_Main-bold;">t</span></span></span><span class="mo" id="MathJax-Span-48912" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="texatom" id="MathJax-Span-48913" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-48914"><span class="mi" id="MathJax-Span-48915" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-48916" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-48917" style="font-family: MathJax_Main;">r</span><span class="mi" id="MathJax-Span-48918" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-48919" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-48920" style="font-family: MathJax_Main;">l</span><span class="mi" id="MathJax-Span-48921" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-48922" style="font-family: MathJax_Main;">z</span><span class="mi" id="MathJax-Span-48923" style="font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-48924" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-48925" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-48926"><span class="mrow" id="MathJax-Span-48927"><span class="mi" id="MathJax-Span-48928" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mo" id="MathJax-Span-48929" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-48930" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48931"><span class="mi" id="MathJax-Span-48932" style="font-family: MathJax_Main-bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-48933" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4156">\mathbf{t} = \mathrm{normalized}(\mathbf{p} \times \mathbf{q})</script> is along the line of intersection of the planes above. (The normalization was not mentioned in <a href="http://www.mathworks.com/matlabcentral/newsreader/view_thread/276271" title="Roger Stafford's on Matlab newsgroup">Roger’s post</a> but it is implemented in the <a href="http://ssb.stsci.edu/doc/stsci_python_x/stsci.sphere.doc/html/_modules/stsci/sphere/great_circle_arc.html" title="intersection">Spherical Geometry Toolkit</a> and by <a href="http://www.jasondavies.com/maps/intersect/" title="great circle arcs intersection">Jason’s example</a>.)</p> <p>Then, let’s define the following quantities: <br><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4157-Frame"><nobr><span class="math" id="MathJax-Span-48934" style="width: 8.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.26em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.998em 1000.003em 5.008em -0.248em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-48935"><span class="mtable" id="MathJax-Span-48936" style="padding-right: 0.153em; padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 6.909em; height: 0px;"><span style="position: absolute; clip: rect(3.356em 1000.003em 8.911em -0.398em); top: -6.254em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(3.406em 1000.003em 4.307em -0.398em); top: -6.304em; right: 0.003em;"><span class="mtd" id="MathJax-Span-48937"><span class="mrow" id="MathJax-Span-48938"><span class="msubsup" id="MathJax-Span-48939"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-48940" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-48941" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.406em 1000.003em 4.307em -0.398em); top: -4.752em; right: 0.003em;"><span class="mtd" id="MathJax-Span-48960"><span class="mrow" id="MathJax-Span-48961"><span class="msubsup" id="MathJax-Span-48962"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-48963" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-48964" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.406em 1000.003em 4.307em -0.398em); top: -3.201em; right: 0.003em;"><span class="mtd" id="MathJax-Span-48983"><span class="mrow" id="MathJax-Span-48984"><span class="msubsup" id="MathJax-Span-48985"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-48986" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-48987" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.406em 1000.003em 4.307em -0.398em); top: -1.649em; right: 0.003em;"><span class="mtd" id="MathJax-Span-49006"><span class="mrow" id="MathJax-Span-49007"><span class="msubsup" id="MathJax-Span-49008"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-49009" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-49010" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.259em;"></span></span><span style="position: absolute; clip: rect(3.456em 1000.003em 9.412em -0.398em); top: -6.654em; left: 0.953em;"><span style="display: inline-block; position: relative; width: 5.958em; height: 0px;"><span style="position: absolute; clip: rect(1.854em 1000.003em 3.156em -0.398em); top: -5.053em; left: 0.003em;"><span class="mtd" id="MathJax-Span-48942"><span class="mrow" id="MathJax-Span-48943"><span class="mo" id="MathJax-Span-48944" style="font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-48945" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="texatom" id="MathJax-Span-48946"><span class="mrow" id="MathJax-Span-48947"><span class="msubsup" id="MathJax-Span-48948"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48949" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48950" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48951" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-48952" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48953"><span class="mi" id="MathJax-Span-48954" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mo" id="MathJax-Span-48955" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-48956" style="font-family: MathJax_Main; padding-left: 0.203em;">⋅</span><span class="texatom" id="MathJax-Span-48957" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48958"><span class="mi" id="MathJax-Span-48959" style="font-family: MathJax_Main-bold;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.003em 3.156em -0.398em); top: -3.501em; left: 0.003em;"><span class="mtd" id="MathJax-Span-48965"><span class="mrow" id="MathJax-Span-48966"><span class="mo" id="MathJax-Span-48967" style="font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-48968" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="texatom" id="MathJax-Span-48969"><span class="mrow" id="MathJax-Span-48970"><span class="msubsup" id="MathJax-Span-48971"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px;"><span style="position: absolute; clip: rect(2.155em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48972" style="font-family: MathJax_Main-bold;">a</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.603em;"><span class="mn" id="MathJax-Span-48973" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48974" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-48975" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48976"><span class="mi" id="MathJax-Span-48977" style="font-family: MathJax_Main-bold;">p</span></span></span><span class="mo" id="MathJax-Span-48978" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-48979" style="font-family: MathJax_Main; padding-left: 0.203em;">⋅</span><span class="texatom" id="MathJax-Span-48980" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48981"><span class="mi" id="MathJax-Span-48982" style="font-family: MathJax_Main-bold;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.003em 3.156em -0.398em); top: -1.949em; left: 0.003em;"><span class="mtd" id="MathJax-Span-48988"><span class="mrow" id="MathJax-Span-48989"><span class="mo" id="MathJax-Span-48990" style="font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-48991" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="texatom" id="MathJax-Span-48992"><span class="mrow" id="MathJax-Span-48993"><span class="msubsup" id="MathJax-Span-48994"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-48995" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-48996" style="font-size: 70.7%; font-family: MathJax_Main-bold;">0</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-48997" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-48998" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-48999"><span class="mi" id="MathJax-Span-49000" style="font-family: MathJax_Main-bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-49001" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-49002" style="font-family: MathJax_Main; padding-left: 0.203em;">⋅</span><span class="texatom" id="MathJax-Span-49003" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-49004"><span class="mi" id="MathJax-Span-49005" style="font-family: MathJax_Main-bold;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; clip: rect(1.854em 1000.003em 3.156em -0.398em); top: -0.398em; left: 0.003em;"><span class="mtd" id="MathJax-Span-49011"><span class="mrow" id="MathJax-Span-49012"><span class="mo" id="MathJax-Span-49013" style="font-family: MathJax_Main;">=</span><span class="mo" id="MathJax-Span-49014" style="font-family: MathJax_Main; padding-left: 0.303em;">(</span><span class="texatom" id="MathJax-Span-49015"><span class="mrow" id="MathJax-Span-49016"><span class="msubsup" id="MathJax-Span-49017"><span style="display: inline-block; position: relative; width: 1.154em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.905em -0.398em); top: -2.75em; left: 0.003em;"><span class="mi" id="MathJax-Span-49018" style="font-family: MathJax_Main-bold;">b</span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.653em;"><span class="mn" id="MathJax-Span-49019" style="font-size: 70.7%; font-family: MathJax_Main-bold;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-49020" style="font-family: MathJax_Main; padding-left: 0.203em;">×</span><span class="texatom" id="MathJax-Span-49021" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-49022"><span class="mi" id="MathJax-Span-49023" style="font-family: MathJax_Main-bold;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-49024" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-49025" style="font-family: MathJax_Main; padding-left: 0.203em;">⋅</span><span class="texatom" id="MathJax-Span-49026" style="padding-left: 0.203em;"><span class="mrow" id="MathJax-Span-49027"><span class="mi" id="MathJax-Span-49028" style="font-family: MathJax_Main-bold;">t</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.659em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 6.447em; vertical-align: -2.942em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4157">\begin{aligned}   s_1 & =  (\mathbf{a_0} \times \mathbf{p})  \cdot \mathbf{t} \\  s_2 & = (\mathbf{a_1} \times \mathbf{p}) \cdot \mathbf{t} \\  s_3 & = (\mathbf{b_0} \times \mathbf{q}) \cdot \mathbf{t} \\  s_4 & = (\mathbf{b_1} \times \mathbf{q}) \cdot \mathbf{t} \end{aligned}</script> </p> <p>(These quantities are crucial: they represent the projection of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4158-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49029" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.954em 1000.003em 2.905em -0.448em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49030"><span class="texatom" id="MathJax-Span-49031"><span class="mrow" id="MathJax-Span-49032"><span class="mi" id="MathJax-Span-49033" style="font-family: MathJax_Main-bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4158">\mathbf{t}</script> along the arcs <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4159-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49034" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49035"><span class="mi" id="MathJax-Span-49036" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4159">a</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4160-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49037" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49038"><span class="mi" id="MathJax-Span-49039" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4160">b</script>.) <br> The arcs <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4161-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49040" style="width: 0.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49041"><span class="mi" id="MathJax-Span-49042" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4161">a</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4162-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49043" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49044"><span class="mi" id="MathJax-Span-49045" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4162">b</script> will intersect <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4163-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49046" style="width: 2.805em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.505em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.055em 1000.003em 2.855em -0.448em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49047"><span class="mspace" id="MathJax-Span-49048" style="height: 0.003em; vertical-align: 0.003em; width: 0.303em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-49049" style="font-family: MathJax_Main;">⟺</span><span class="mspace" id="MathJax-Span-49050" style="height: 0.003em; vertical-align: 0.003em; width: 0.303em; display: inline-block; overflow: hidden;"></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.725em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4163">\iff</script> <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4164-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49051" style="width: 1.954em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.754em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.105em 1000.003em 3.006em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49052"><span class="mo" id="MathJax-Span-49053" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-49054"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-49055" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-49056" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4164">-s_1</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4165-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49057" style="width: 1.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49058"><span class="msubsup" id="MathJax-Span-49059"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-49060" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-49061" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4165">s_2</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4166-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49062" style="width: 1.954em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.754em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.105em 1000.003em 3.006em -0.348em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49063"><span class="mo" id="MathJax-Span-49064" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-49065"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-49066" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-49067" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4166">-s_3</script>, and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4167-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49068" style="width: 1.104em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.004em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.555em -0.398em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49069"><span class="msubsup" id="MathJax-Span-49070"><span style="display: inline-block; position: relative; width: 0.953em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-49071" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.25em; left: 0.503em;"><span class="mn" id="MathJax-Span-49072" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4167">s_4</script> are all of the same sign. In that case they intersect along <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4168-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49073" style="width: 1.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.954em 1000.003em 3.006em -0.398em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49074"><span class="mo" id="MathJax-Span-49075" style="font-family: MathJax_Main;">+</span><span class="texatom" id="MathJax-Span-49076"><span class="mrow" id="MathJax-Span-49077"><span class="mi" id="MathJax-Span-49078" style="font-family: MathJax_Main-bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.164em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4168">+\mathbf{t}</script> if they are all positive or along <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4169-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49079" style="width: 1.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.954em 1000.003em 2.905em -0.348em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49080"><span class="mo" id="MathJax-Span-49081" style="font-family: MathJax_Main;">−</span><span class="texatom" id="MathJax-Span-49082"><span class="mrow" id="MathJax-Span-49083"><span class="mi" id="MathJax-Span-49084" style="font-family: MathJax_Main-bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4169">-\mathbf{t}</script> if all are negative. <br>(Jason tests against <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4170-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49085" style="width: 4.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.806em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.704em 1000.003em 2.855em -0.398em); top: -2.7em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49086"><span class="mi" id="MathJax-Span-49087" style="font-family: MathJax_Math-italic;">ϵ</span><span class="mo" id="MathJax-Span-49088" style="font-family: MathJax_Main; padding-left: 0.303em;">=</span><span class="msubsup" id="MathJax-Span-49089" style="padding-left: 0.303em;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.348em); top: -2.7em; left: 0.003em;"><span class="mn" id="MathJax-Span-49090" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; top: -2.8em; left: 1.004em;"><span class="texatom" id="MathJax-Span-49091"><span class="mrow" id="MathJax-Span-49092"><span class="mo" id="MathJax-Span-49093" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-49094" style="font-size: 70.7%; font-family: MathJax_Main;">6</span></span></span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.114em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4170">\epsilon = 10^{-6}</script>, I implemented the test against the sign.)</p> <p>If they do intersect, you can transform the corresponding vector, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4171-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49095" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.954em 1000.003em 2.905em -0.448em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49096"><span class="texatom" id="MathJax-Span-49097"><span class="mrow" id="MathJax-Span-49098"><span class="mi" id="MathJax-Span-49099" style="font-family: MathJax_Main-bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4171">\mathbf{t}</script> or <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4172-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49100" style="width: 1.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.954em 1000.003em 2.905em -0.348em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49101"><span class="mo" id="MathJax-Span-49102" style="font-family: MathJax_Main;">−</span><span class="texatom" id="MathJax-Span-49103"><span class="mrow" id="MathJax-Span-49104"><span class="mi" id="MathJax-Span-49105" style="font-family: MathJax_Main-bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4172">-\mathbf{t}</script>, back into longitude and latitude (without worrying about its length.) Letting <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4173-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49106" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49107"><span class="mi" id="MathJax-Span-49108" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4173">x</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4174-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49109" style="width: 0.553em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.448em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49110"><span class="mi" id="MathJax-Span-49111" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4174">y</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4175-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49112" style="width: 0.553em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49113"><span class="mi" id="MathJax-Span-49114" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.614em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4175">z</script> be <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4176-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49115" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.954em 1000.003em 2.905em -0.448em); top: -2.75em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49116"><span class="texatom" id="MathJax-Span-49117"><span class="mrow" id="MathJax-Span-49118"><span class="mi" id="MathJax-Span-49119" style="font-family: MathJax_Main-bold;">t</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.755em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.836em; vertical-align: -0.053em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4176">\mathbf{t}</script>’s Cartesian coordinates this reverse transformation can be accomplished this way:</p> <p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-43-Frame"><nobr><span class="math" id="MathJax-Span-468" style="width: 12.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.414em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.203em 1000.003em 3.806em -0.248em); top: -2.25em; left: 0.003em;"><span class="mrow" id="MathJax-Span-469"><span class="mtable" id="MathJax-Span-470" style="padding-right: 0.153em; padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 11.064em; height: 0px;"><span style="position: absolute; clip: rect(2.005em 1000.003em 5.208em -0.398em); top: -4.002em; left: 0.003em;"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 2.655em -0.398em); top: -3.601em; right: 0.003em;"><span class="mtd" id="MathJax-Span-471"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; clip: rect(1.654em 1000.003em 2.855em -0.398em); top: -1.649em; right: 0.003em;"><span class="mtd" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math-italic;">ϕ</span></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.305em 1000.003em 5.858em -0.398em); top: -4.302em; left: 0.603em;"><span style="display: inline-block; position: relative; width: 10.463em; height: 0px;"><span style="position: absolute; clip: rect(1.804em 1000.003em 3.106em -0.398em); top: -3.801em; left: 0.003em;"><span class="mtd" id="MathJax-Span-474"><span class="mrow" id="MathJax-Span-475"><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">=</span><span class="texatom" id="MathJax-Span-477" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-478"><span class="texatom" id="MathJax-Span-479"><span class="mrow" id="MathJax-Span-480"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Main;">a</span></span></span><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math-italic;">n</span><span class="mn" id="MathJax-Span-487" style="font-family: MathJax_Main;">2</span></span></span><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math-italic; padding-left: 0.153em;">x</span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(1.354em 1000.003em 3.456em -0.398em); top: -1.849em; left: 0.003em;"><span class="mtd" id="MathJax-Span-496"><span class="mrow" id="MathJax-Span-497"><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main;">=</span><span class="texatom" id="MathJax-Span-499" style="padding-left: 0.303em;"><span class="mrow" id="MathJax-Span-500"><span class="texatom" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Main;">a</span></span></span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic;">n</span><span class="mn" id="MathJax-Span-509" style="font-family: MathJax_Main;">2</span></span></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">,</span><span class="msqrt" id="MathJax-Span-513" style="padding-left: 0.153em;"><span style="display: inline-block; position: relative; width: 4.307em; height: 0px;"><span style="position: absolute; clip: rect(1.654em 1000.003em 3.056em -0.398em); top: -2.7em; left: 1.004em;"><span class="mrow" id="MathJax-Span-514"><span class="msubsup" id="MathJax-Span-515"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.655em -0.398em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.603em;"><span class="mn" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main; padding-left: 0.203em;">+</span><span class="msubsup" id="MathJax-Span-519" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 1.054em; height: 0px;"><span style="position: absolute; clip: rect(1.904em 1000.003em 2.855em -0.448em); top: -2.5em; left: 0.003em;"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.505em;"></span></span><span style="position: absolute; top: -2.8em; left: 0.553em;"><span class="mn" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.405em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span><span style="position: absolute; clip: rect(3.606em 1000.003em 4.007em -0.448em); top: -4.902em; left: 1.004em;"><span style="display: inline-block; position: relative; width: 3.306em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.002em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.002em; left: 2.655em;">−<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.002em; left: 0.453em;">−<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.002em; left: 1.004em;">−<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.002em; left: 1.554em;">−<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.002em; left: 2.105em;">−<span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(2.705em 1000.003em 4.807em -0.348em); top: -4.052em; left: 0.003em;"><span style="font-family: MathJax_Size2;">√</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.705em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.307em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.255em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.836em; vertical-align: -1.608em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">\begin{aligned}  \theta & = {\mathrm arctan2} (y,x) \\ \phi    & = {\mathrm arctan2}(z, \sqrt{x^2+y^2}) \end{aligned}</script> </p> <iframe src="http://bl.ocks.org/espinielli/raw/00f6062b0324eac6f882/" scrolling="no" width="800px" height="500px"></iframe>   <h3 id="references">References</h3> <ul><li><a href="http://www.mathworks.com/matlabcentral/newsreader/view_thread/276271" title="Roger Stafford's on Matlab newsgroup">Roger Stafford’s post</a> on Matlab newsgroup  (but it lacks the normalization step which is instead used in Jason Davies code, and in Spherical Geometry Toolkit)</li><li><a href="http://ssb.stsci.edu/doc/stsci_python_x/stsci.sphere.doc/html/_modules/stsci/sphere/great_circle_arc.html" title="intersection">implementation in Python</a> as part of the <a href="http://ssb.stsci.edu/doc/stsci_python_x/stsci.sphere.doc/html/" title="spherical geometry toolkit">Spherical Geometry Toolkit</a></li><li>Jason Davies <a href="http://www.jasondavies.com/maps/intersect/" title="great circle arcs intersection">implementation</a> in D3.js</li></ul> <blockquote>  <p>Written and published with <a href="https://stackedit.io/">StackEdit</a>.</p></blockquote>